<ion-header>
  <ion-navbar color="primary">
		<ion-title *ngIf="!editando"><h1>Cadastro de Pedido - {{ model.id }}</h1></ion-title>
    <ion-title *ngIf="editando"><h1>Alteração de Pedido - {{ model.id }}</h1></ion-title>
  </ion-navbar>
</ion-header>

<ion-content>
	<ion-list>
	    <!-- <ion-item>
		  <ion-label floating>Cliente</ion-label>
		  <ion-select interface="popover" name="cliente_id" [(ngModel)]="model.cliente_id">
	        <ion-option *ngFor="let cliente of clientes" value="{{ cliente.id }}">{{ cliente.nome}}</ion-option>
	      </ion-select>
			</ion-item> -->
			<ion-grid>
					<ion-row>
						<ion-col col-12>
							<ion-item-group >
									<ion-item>
										<select-searchable
											[(ngModel)]="model_cliente"
											itemValueField="id"
											itemTextField="nome"
											[items]="clientes"
											[canSearch]="true"
											(onChange)="clienteChange($event)">
											<ng-template selectSearchableLabelTemplate >
												Cliente
											</ng-template>
										</select-searchable>
									</ion-item>
								</ion-item-group>
						</ion-col>
					</ion-row>
			</ion-grid>
	    <ion-item>
		  <ion-label >Data</ion-label>
		  <!-- <ion-input type="datetime-local" [(ngModel)]="model.data"></ion-input> --> 
			<ion-datetime displayFormat="DD/MM/YYYY" doneText="OK" cancelText="Cancelar" [(ngModel)]="model.data"></ion-datetime>
			</ion-item>
	</ion-list>
    <!-- <hr> -->
	<ion-list>
			<ion-item-divider color="primary"><h1>Produtos</h1></ion-item-divider>	
    <!-- <ion-item>
		  <h1>Produtos</h1>
	  </ion-item> -->
		<ion-item-sliding *ngFor="let item of itens">
	      <button ion-item>
					<h2>{{ item.nome_produto }}</h2>
					<h2>Quant.: <b ion-text color="danger">{{ item.quantidade }}</b>
						  Valor: <b ion-text color="danger">{{ item.valor_unitario| number:'1.2-2' }}</b>
						  Total: <b ion-text color="danger">{{ item.quantidade * item.valor_unitario | number:'1.2-2' }}</b>
					</h2>
	      </button>
	      <ion-item-options side="left">
	        <button ion-button color="danger" (click)="removeProduto(item)">
	          <ion-icon name="trash"></ion-icon>
	          Excluir
	        </button>
	      </ion-item-options>
	    </ion-item-sliding>
	</ion-list>

	<ion-list>
		<ion-grid>
			<ion-row>
				<ion-col col-12>
					<ion-item-group margin-bottom>
							<ion-item>
								<select-searchable
									[(ngModel)]="model_produto"
									itemValueField="id"
									itemTextField="nome_produto"
									[items]="produtos"
									[canSearch]="true"
									(onChange)="produtoChange($event)">
									<ng-template floating selectSearchableLabelTemplate >
										Item
									</ng-template>
								</select-searchable>
							</ion-item>
						</ion-item-group>
				</ion-col>
			</ion-row>
		  <!-- <ion-row>
		    <ion-col col-12>
			    <ion-item>
					<ion-label floating>Item</ion-label>
					<ion-select interface="popover" name="id" [(ngModel)]="model_item_pedido.produto_id" (ionChange)="onSelectChange($event);">
				      <ion-option *ngFor="let produto of produtos" value="{{ produto.id }}">{{ produto.nome_produto }}</ion-option>
				    </ion-select>
			    </ion-item>
				</ion-col>
			</ion-row> -->
			<ion-row>
		    <ion-col col-6>	    
			    <ion-item>
				    <ion-label floating>Quantidade</ion-label>
				    <ion-input type="number" [(ngModel)]="model_item_pedido.quantidade" required></ion-input>
			    </ion-item>
        </ion-col>
        <ion-col col-6>	    
			    <ion-item>
				    <ion-label floating>Preço</ion-label>
				    <ion-input type="number" [(ngModel)]="model_item_pedido.valor_unitario" required></ion-input>
			    </ion-item>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col col-8 offset-2>
          <button ion-button block (click)="addItem()" >Adicionar Produto</button>
        </ion-col>
      </ion-row>
    </ion-grid>
	</ion-list>
    <hr>
	<div padding>
    <button *ngIf="!editando" ion-button block (click)="save()">Criar Pedido</button>
		<button *ngIf="editando" ion-button block (click)="save()">Atualizar Pedido</button>
	  <!-- <button ion-button color="light" block (click)="cancelar()" >Cancelar</button> -->
  </div>


</ion-content>
